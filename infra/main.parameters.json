{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {

    "environmentName":                     { "value": "${AZURE_ENV_NAME}" },
    "location":                            { "value": "${AZURE_LOCATION}" },
    "aiFoundryLocation":                   { "value": "${AZURE_AI_FOUNDRY_LOCATION}" },
    "psqlLocation":                        { "value": "${AZURE_PSQL_LOCATION}" },
    "cosmosLocation":                        { "value": "${AZURE_COSMOS_LOCATION}" },
    "deploymentTags":                      { "value": {} },
    "principalId":                         { "value": "${AZURE_PRINCIPAL_ID}" },

    "networkIsolation":                    { "value": "${NETWORK_ISOLATION}" },
    "useUAI":                              { "value": "${USE_UAI}" },
    "useCAppAPIKey":                       { "value": "${USE_CAPP_API_KEY}" },    
    "useZoneRedundancy":                   { "value": "false" },    
    "enableAgenticRetrieval":              { "value": "${ENABLE_AGENTIC_RETRIEVAL}" },

    "aiSearchResourceId":                  { "value": null },
    "aiFoundryStorageAccountResourceId":   { "value": null },
    "aiFoundryCosmosDBAccountResourceId":  { "value": null },
    
    "deployAiFoundry":                      { "value": "true" },
    "deployAiFoundrySubnet":                { "value": "false" },
    "deployAppConfig":                      { "value": "true" },
    "deployAppInsights":                    { "value": "true" },
    "deployCosmosDb":                       { "value": "true" },
    "deployContainerApps":                  { "value": "true" },
    "deployContainerRegistry":              { "value": "true" },
    "deployContainerEnv":                   { "value": "true" },
    "deployNsgs":                           { "value": "true" },
    "deployMcp":                            { "value": "true" },
    "deployGroundingWithBing":              { "value": "false" },
    "deployKeyVault":                       { "value": "true" },
    "deployVmKeyVault":                     { "value": "${DEPLOY_VM_KEY_VAULT}" },
    "deployLogAnalytics":                   { "value": "true" },
    "deploySearchService":                  { "value": "true" },
    "deployStorageAccount":                 { "value": "true" },
    "greenFieldDeployment":                 { "value": "true" },
    "deployVM":                             { "value": "true" },
    "deploySoftware":                       { "value": "true" },
    "deployPostgres":                       { "value": "false" },

    "aiFoundryAccountName":                  { "value": null },
    "aiFoundryProjectName":                  { "value": null },
    "aiFoundryProjectDisplayName":           { "value": null },
    "aiFoundryProjectDescription":           { "value": null },    
    "aiFoundryStorageAccountName":           { "value": null },
    "aiFoundrySearchServiceName":            { "value": null },
    "aiFoundryCosmosDbName":                 { "value": null },
    "bingSearchName":                        { "value": null },  
    "appConfigName":                         { "value": null },
    "appInsightsName":                       { "value": null },
    "containerEnvName":                      { "value": null },
    "containerRegistryName":                 { "value": null },
    "conversationContainerName":             { "value": null },
    "dataIngestContainerAppName":            { "value": null },
    "datasourcesContainerName":              { "value": null },
    "dbAccountName":                         { "value": null },
    "dbDatabaseName":                        { "value": null },
    "frontEndContainerAppName":              { "value": null },
    "keyVaultName":                          { "value": null },
    "logAnalyticsWorkspaceName":             { "value": null },
    "searchServiceName":                     { "value": null },
    "solutionStorageAccountName":            { "value": null },

    "vmAdminPassword":                       {"value": "$(secretOrRandomPassword)"},  
    "vmSize":                                { "value": "Standard_D8s_v5" },

    "useCMK":                                { "value": "false" },
    "useExistingVNet":                       { "value": "${USE_EXISTING_VNET}" },  
    "deploySubnets":                         { "value": "${DEPLOY_SUBNETS}" },  
    "sideBySideDeploy":                      { "value": "${SIDE_BY_SIDE}" }, 
    "existingVnetResourceId":                { "value": "${EXISTING_VNET_RESOURCE_ID}" },     

    "modelDeploymentList":{
      "value": [
        {
          "name": "chat",
          "model": {
            "format": "OpenAI",
            "name": "gpt-4o",
            "version": "2024-11-20"
          },
          "sku": {
            "name": "GlobalStandard",
            "capacity": 40
          },
          "canonical_name": "CHAT_DEPLOYMENT_NAME",
          "apiVersion": "2025-01-01-preview"
        },
        {
          "name": "text-embedding",
          "model": {
            "format": "OpenAI",
            "name": "text-embedding-3-large",
            "version": "1"
          },
          "sku": {
            "name": "Standard",
            "capacity": 40
          },
          "canonical_name": "EMBEDDING_DEPLOYMENT_NAME",
          "apiVersion": "2025-01-01-preview"
        }
      ]
    },

    "workloadProfiles" : {
      "value": [
        {
          "name": "Consumption",
          "workloadProfileType": "Consumption"
        },
        {
          "workloadProfileType": "D4",
          "name": "main",
          "minimumCount": 0,
          "maximumCount": 1
        }
      ]
    },

    "storageAccountContainersList": {
      "value": [
        {
          "name": "documents-images",
          "canonical_name": "DOCUMENTS_IMAGES_STORAGE_CONTAINER"          
        },
        {
          "name": "documents",
          "canonical_name": "DOCUMENTS_STORAGE_CONTAINER"
        },
        {
          "name": "nl2sql",
          "canonical_name": "NL2SQL_STORAGE_CONTAINER"
        }
      ]
    },  

    "databaseContainersList": {
      "value": [
        {
          "name": "conversations",
          "canonical_name": "CONVERSATIONS_DATABASE_CONTAINER"
        },
        {
          "name": "datasources",
          "canonical_name": "DATASOURCES_DATABASE_CONTAINER"
        },
        {
          "name": "prompts",
          "canonical_name": "PROMPTS_CONTAINER"
        },
        {
          "name": "mcp",
          "canonical_name": "MCP_CONTAINER"
        }
      ]
    },

    "containerAppsList": {
      "value": [
        {
          "name": null,
          "external" : true,
          "service_name": "orchestrator",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "ORCHESTRATOR_APP",
          "roles": [
            "AppConfigurationDataReader",
            "CognitiveServicesUser",
            "CognitiveServicesOpenAIUser",
            "AcrPull",
            "CosmosDBBuiltInDataContributor",
            "SearchIndexDataReader",
            "StorageBlobDataReader",
            "KeyVaultSecretsUser"
          ]
        },
        {
          "name": null,
          "external" : true,
          "service_name": "frontend",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "FRONTEND_APP",          
          "roles": [
            "AppConfigurationDataReader",
            "AcrPull",
            "StorageBlobDataReader",
            "StorageBlobDelegator",
            "KeyVaultSecretsUser"
          ]
        },
        {
          "name": null,
          "external" : true,
          "service_name": "dataingest",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "DATA_INGEST_APP",
          "roles": [
            "AppConfigurationDataReader",
            "CognitiveServicesUser",
            "CognitiveServicesOpenAIUser",
            "CosmosDBBuiltInDataContributor",
            "AcrPull",
            "SearchIndexDataContributor",
            "StorageBlobDataContributor",
            "KeyVaultSecretsUser"
          ]
        },
        {
          "name": null,
          "external" : true,
          "service_name": "mcp",
          "profile_name": "main",
          "min_replicas": 1,
          "max_replicas": 1,
          "canonical_name": "MCP_APP",
          "roles": [
            "AppConfigurationDataReader",
            "CognitiveServicesUser",
            "CognitiveServicesOpenAIUser",
            "CosmosDBBuiltInDataContributor",
            "AcrPull",
            "SearchIndexDataContributor",
            "StorageBlobDataContributor",
            "StorageQueueDataContributor",
            "KeyVaultSecretsUser"
          ]
        }
      ]
    }
  }
}



  
      
